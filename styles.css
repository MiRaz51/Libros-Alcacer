:root{ --bg:#0b111b; --fg:#e7edf5; --muted:#9fb3c8; --card:#121a26; --border:#1f2a3a; --primary:#3aa9ff; --danger:#ff5d5d; --accent:#28d17c; }
*{ box-sizing: border-box; }
html,body{ height:100%; }
body{ margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background: var(--bg); color: var(--fg); -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
input, select, textarea, button{ -webkit-appearance: none; -moz-appearance: none; appearance: none; }
.container{ max-width: 1100px; margin: 24px auto; padding: 0 16px; }
h1{ margin: 0 0 12px; font-weight: 650; }
.stats-container{ display: flex; flex-direction: column; gap: 8px; margin-bottom: 16px; padding: 12px 16px; background: var(--card); border: 1px solid var(--border); border-radius: 8px; }
.stats-row{ display: flex; gap: 24px; padding-top: 4px; border-top: 1px solid var(--border); }
.stats-row:first-child{ padding-top: 0; border-top: none; }
.stat-item{ display: flex; gap: 8px; align-items: center; }
.stat-label{ font-size: 14px; color: var(--muted); }
.stat-value{ font-size: 18px; font-weight: 600; color: var(--fg); }
.stat-value.stat-disponible{ color: #4ade80; }
.stat-value.stat-prestado{ color: #f87171; }
.filtros-aplicados{ font-size: 13px; color: var(--muted); font-style: italic; }
.filtros-aplicados:empty{ display: none; }
.toolbar{ display: flex; gap: 8px; margin-bottom: 12px; }
.toolbar input{ flex:1; padding:8px 10px; border-radius:8px; border:1px solid var(--border); background: var(--card); color: var(--fg); }
.toolbar button{ padding:8px 12px; border-radius:8px; border:1px solid var(--border); background: var(--primary); color: #07111e; cursor:pointer; }
.toolbar button:hover{ filter: brightness(1.1); }
.toolbar .help-btn{ background: var(--accent); font-size: 18px; padding: 8px 14px; margin-left: auto; }
.card{ background: var(--card); border:1px solid var(--border); border-radius:12px; padding: 8px; position: relative; }
.card::after{ content: '→'; position: absolute; right: 8px; top: 50%; transform: translateY(-50%); font-size: 24px; color: var(--primary); pointer-events: none; opacity: 0; transition: opacity 0.3s; animation: pulse 2s infinite; }
.card.has-scroll::after{ opacity: 0.7; }
@keyframes pulse {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 0.3; }
}

 table{ width:100%; border-collapse: collapse; }
 thead th{ position: sticky; top:0; background: #0f1623; }
 th, td{ border-bottom:1px solid var(--border); padding: 10px; text-align:left; }
 th.sortable{ cursor: pointer; user-select: none; white-space: nowrap; }
 th.sortable:hover{ background: #1a2332; }
 tr:hover{ background: rgba(255,255,255,0.03); }
 .estado-badge{ padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 500; display: inline-block; }
 .estado-disponible{ background: #1a4d2e; color: #4ade80; border: 1px solid #22c55e; }
 .estado-prestado{ background: #4d1a1a; color: #f87171; border: 1px solid #ef4444; }
 .estado-display{ display: flex; align-items: center; }
 /* Estado en diálogo - más grande y visible */
 dialog .estado-badge{ 
   padding: 16px 24px; 
   font-size: 18px; 
   font-weight: 600; 
   border-radius: 16px; 
   width: 100%; 
   text-align: center;
   display: block;
   margin: 8px 0;
   border-width: 2px;
 }
 .dialog-footer{ display: flex; justify-content: flex-end; padding: 16px; border-top: 1px solid var(--border); }
 .btn-cerrar-footer{ padding: 10px 24px; border-radius: 8px; border: 1px solid var(--border); background: var(--accent); color: #031414; cursor: pointer; font-weight: 500; }
 .actions{ white-space: nowrap; }
 button{ padding:6px 10px; border-radius: 8px; border:1px solid var(--border); background: var(--accent); color: #031414; cursor: pointer; }
 button:disabled{ opacity: 0.5; cursor: not-allowed; }
 button.secondary{ background: #8bb3ff; }
 button.danger{ background: var(--danger); color: #240202; }
 button:focus{ outline:2px solid var(--primary); outline-offset: 2px; }

 dialog{ border:1px solid var(--border); border-radius: 12px; background: var(--card); color: var(--fg); padding: 0; max-width: 1200px; width: 95vw; }
 dialog form{ padding: 16px; }
 dialog::backdrop{ background: rgba(0,0,0,0.5); }
 .dialog-container{ display: flex; gap: 20px; align-items: stretch; }
 .dialog-container > .grid{ flex: 1; min-width: 0; }
 .portada-column{ width: 320px; flex-shrink: 0; display: flex; flex-direction: column; gap: 8px; }
 .portada-column h4{ margin: 0; font-size: 14px; font-weight: 600; color: var(--muted); }
 .portada-placeholder{ width: 100%; flex: 1; border: 1px solid var(--border); border-radius: 8px; display: flex; align-items: center; justify-content: center; background: #0a0e15; color: var(--muted); font-size: 14px; }
 .portada-column img{ width: 100%; height: 100%; object-fit: cover; border-radius: 8px; border: 1px solid var(--border); }
 .resumen-column{ width: 320px; flex-shrink: 0; display: flex; flex-direction: column; gap: 8px; min-height: 400px; }
 .resumen-column h4{ margin: 0; font-size: 14px; font-weight: 600; color: var(--muted); }
 .resumen-texto{ padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: #0a0e15; color: var(--fg); font-size: 13px; line-height: 1.6; flex: 1; overflow-y: auto; white-space: pre-wrap; min-height: 300px; }
 .resumen-texto.sin-contenido{ display: flex; align-items: center; justify-content: center; color: var(--muted); font-size: 14px; padding: 12px; white-space: normal; min-height: 200px; }
 .loading-message{ text-align: center; padding: 3rem; }
 .loading-message-title{ font-size: 1.2rem; margin-bottom: 1rem; }
 .loading-message-subtitle{ color: #666; font-size: 0.9rem; }
 .loading-indicator{ text-align: center; padding: 2rem; color: #666; }
 .loading-indicator-icon{ font-size: 2rem; margin-bottom: 0.5rem; }
 .loading-indicator-text{ font-size: 1rem; font-weight: 500; }
 .loading-indicator-subtext{ font-size: 0.85rem; margin-top: 0.5rem; opacity: 0.8; }
 label{ display:flex; flex-direction: column; gap:6px; font-size: 13px; color: var(--muted); }
 input, select, textarea{ padding:10px; border-radius: 8px; border:1px solid var(--border); background: #0f1623; color: var(--fg); font-family: inherit; }
 textarea{ resize: vertical; }
 input:disabled, select:disabled, textarea:disabled{ opacity: 0.5; cursor: wait; }
 input:read-only, textarea:read-only{ background: #0a0e15; cursor: default; }
 .grid{ display: grid; grid-template-columns: repeat(2,minmax(0,1fr)); gap: 12px; }
 .grid .full{ grid-column: 1 / -1; }
 .prestamo-row{ grid-column: 1 / -1; display: flex; gap: 12px; align-items: flex-end; }
 .prestamo-row label{ flex: 1; }
 .prestamo-row button{ flex-shrink: 0; margin-bottom: 0; }

 .help-dialog{ max-width: 900px; width: 90vw; max-height: 85vh; border: 1px solid var(--border); border-radius: 12px; background: var(--card); color: var(--fg); padding: 0; }
 .help-header{ display: flex; justify-content: space-between; align-items: center; padding: 20px 24px; border-bottom: 1px solid var(--border); background: var(--bg); }
 .help-header h2{ margin: 0; font-size: 24px; color: var(--primary); }
 .help-close{ background: transparent; border: none; color: var(--muted); font-size: 28px; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 4px; }
 .help-close:hover{ background: var(--border); color: var(--fg); }
 .help-content{ padding: 24px; overflow-y: auto; max-height: calc(85vh - 80px); line-height: 1.6; }
 .help-content h1{ color: var(--primary); font-size: 28px; margin-top: 0; }
 .help-content h2{ color: var(--accent); font-size: 22px; margin-top: 24px; border-bottom: 1px solid var(--border); padding-bottom: 8px; }
 .help-content h3{ color: var(--fg); font-size: 18px; margin-top: 16px; }
/* List spacing tightened for better readability */
.help-content ul, .help-content ol{ margin: 0 0 8px 20px !important; padding-left: 20px !important; }
.help-content li{ margin: 2px 0 !important; line-height: 1.5 !important; }
.help-content p{ margin: 4px 0 !important; }
/* Eliminar completamente el espacio entre párrafos y listas */
.help-content p + ul, .help-content p + ol{ margin-top: -6px !important; }
/* If a list item contains a paragraph, remove its margins to avoid extra gaps */
.help-content li p{ margin: 0 !important; }
 .help-content strong{ color: var(--primary); }
 .help-content code{ background: var(--bg); padding: 2px 6px; border-radius: 4px; font-family: 'Courier New', monospace; }
 .help-content pre{ background: var(--bg); padding: 12px; border-radius: 8px; overflow-x: auto; }

 .footer{ margin-top: 48px; padding: 24px 0; border-top: 1px solid var(--border); text-align: center; }
 .footer-content{ display: flex; flex-direction: column; gap: 12px; align-items: center; }
 .footer-content p{ margin: 0; font-size: 13px; color: var(--muted); }
 .footer-links{ display: flex; gap: 12px; align-items: center; font-size: 13px; }
 .footer-links a{ color: var(--primary); text-decoration: none; transition: color 0.2s; }
 .footer-links a:hover{ color: var(--accent); text-decoration: underline; }
 .footer-links .separator{ color: var(--muted); }

/* Responsive - Tablets */
@media (max-width: 768px) {
  .container{ margin: 16px auto; padding: 0 12px; }
  h1{ font-size: 24px; }
  
  /* Toolbar responsive - mismo layout que móvil */
  .toolbar{ flex-wrap: wrap; gap: 10px; }
  
  /* Línea 1: Input búsqueda + Categoría (50% - 50%) */
  .toolbar input{ 
    font-size: 17px;
    padding: 14px 12px;
    flex: 1 1 calc(50% - 5px);
    min-width: 0;
    order: 1;
    min-height: 50px;
  }
  .toolbar #selCategoria{ 
    font-size: 15px; 
    padding: 12px 10px;
    flex: 1 1 calc(50% - 5px);
    min-width: 0;
    order: 2;
    min-height: 50px;
  }
  
  /* Línea 2: Caja + Estado */
  .toolbar #selCaja{ 
    font-size: 15px; 
    padding: 12px 10px;
    flex: 1 1 calc(50% - 5px);
    min-width: 0;
    order: 3;
    min-height: 48px;
  }
  .toolbar #selEstado{ 
    font-size: 15px; 
    padding: 12px 10px;
    flex: 1 1 calc(50% - 5px);
    min-width: 0;
    order: 4;
    min-height: 48px;
  }
  
  /* Línea 3: Buscar + Limpiar + Imprimir + Ayuda */
  .toolbar #btnBuscar{ 
    font-size: 15px; 
    padding: 12px 8px;
    flex: 1 1 calc(25% - 8px);
    min-width: 0;
    order: 5;
    min-height: 48px;
  }
  .toolbar #btnReset{ 
    font-size: 15px; 
    padding: 12px 8px;
    flex: 1 1 calc(25% - 8px);
    min-width: 0;
    order: 6;
    min-height: 48px;
  }
  .toolbar #btnPrint{ 
    font-size: 15px; 
    padding: 12px 8px;
    flex: 1 1 calc(25% - 8px);
    min-width: 0;
    order: 7;
    min-height: 48px;
  }
  .toolbar .help-btn{ 
    font-size: 18px;
    padding: 12px 8px;
    flex: 1 1 calc(25% - 8px);
    min-width: 0;
    order: 8;
    min-height: 48px;
  }
  
  /* Stats responsive */
  .stats-row{ flex-wrap: wrap; gap: 16px; }
  .stat-item{ flex: 1; min-width: 140px; }
  
  /* Tabla responsive - columnas delgadas con wrap */
  .card{ 
    overflow-x: auto; 
    -webkit-overflow-scrolling: touch;
  }
  table{ 
    font-size: 12px;
    width: 100%;
    min-width: 100%;
    table-layout: fixed;
  }
  th, td{ 
    padding: 8px 6px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  th.sortable{ 
    font-size: 12px;
  }
  /* Título - columna con wrap */
  td:nth-child(1), th:nth-child(1){ 
    width: 33%;
    white-space: normal;
    word-wrap: break-word;
    line-height: 1.4;
  }
  /* Categoría - columna con wrap */
  td:nth-child(2), th:nth-child(2){ 
    width: 26%;
    white-space: normal;
    word-wrap: break-word;
    line-height: 1.4;
  }
  /* Caja - columna delgada */
  td:nth-child(3), th:nth-child(3){ 
    width: 10%;
    text-align: center;
  }
  /* Estado - columna para badge */
  td:nth-child(4), th:nth-child(4){ 
    width: 19%;
    padding: 8px 4px;
  }
  /* Acción - columna para botón */
  td:nth-child(5), th:nth-child(5){ 
    width: 12%;
    padding: 8px 4px;
  }
  .estado-badge{ 
    font-size: 10px; 
    padding: 4px 8px;
    display: inline-block;
    width: 100%;
    text-align: center;
    box-sizing: border-box;
    white-space: normal;
    word-wrap: break-word;
    line-height: 1.3;
  }
  
  /* Diálogo responsive - reorganizado en columna única */
  dialog{ max-width: 95vw; }
  
  /* Estado en diálogo tablet - grande y visible */
  dialog .estado-badge{ 
    padding: 18px 24px; 
    font-size: 19px; 
    font-weight: 700; 
    border-radius: 18px;
    margin: 10px 0;
    border-width: 2px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.25);
  }
  .dialog-container{ flex-direction: column; gap: 16px; }
  .dialog-container > .grid{ order: 1; }
  .portada-column{ order: 2; width: 100%; max-width: 100%; }
  .resumen-column{ order: 3; width: 100%; max-width: 100%; }
  .grid{ grid-template-columns: 1fr; }
  .portada-column img{ max-height: 350px; object-fit: contain; }
  .resumen-texto{ min-height: 200px; }
  
  /* Botones de préstamo/devolución en tablet */
  .prestamo-row{ flex-direction: column; gap: 8px; align-items: stretch; }
  .prestamo-row label{ width: 100%; }
  .prestamo-row button{ width: 100%; margin-top: 4px; padding: 10px; }
  
  /* Footer responsive */
  .footer-links{ flex-wrap: wrap; justify-content: center; }
}

/* Responsive - Móviles */
@media (max-width: 480px) {
  .container{ margin: 12px auto; padding: 0 8px; }
  h1{ font-size: 20px; margin-bottom: 8px; }
  
  /* Toolbar móvil - layout personalizado: texto+cat, caja+estado, 4 botones */
  .toolbar{ gap: 10px; }
  
  /* Línea 1: Input búsqueda + Categoría (50% - 50%) */
  .toolbar input{ 
    font-size: 18px; 
    padding: 16px 14px; 
    flex: 1 1 calc(50% - 5px);
    min-width: 0;
    order: 1;
    min-height: 52px;
    font-weight: 400;
  }
  .toolbar #selCategoria{ 
    font-size: 15px; 
    padding: 14px 10px; 
    flex: 1 1 calc(50% - 5px);
    min-width: 0;
    order: 2;
    min-height: 52px;
  }
  
  /* Línea 2: Caja + Estado */
  .toolbar #selCaja{ 
    font-size: 15px; 
    padding: 14px 10px; 
    flex: 1 1 calc(50% - 5px);
    min-width: 0;
    order: 3;
    min-height: 50px;
  }
  .toolbar #selEstado{ 
    font-size: 15px; 
    padding: 14px 10px; 
    flex: 1 1 calc(50% - 5px);
    min-width: 0;
    order: 4;
    min-height: 50px;
  }
  
  /* Línea 3: Buscar + Limpiar + Imprimir + Ayuda (4 botones) */
  .toolbar #btnBuscar{ 
    font-size: 15px; 
    padding: 14px 8px; 
    flex: 1 1 calc(25% - 8px);
    min-width: 0;
    white-space: nowrap;
    order: 5;
    min-height: 50px;
    font-weight: 500;
  }
  .toolbar #btnReset{ 
    font-size: 15px; 
    padding: 14px 8px; 
    flex: 1 1 calc(25% - 8px);
    min-width: 0;
    white-space: nowrap;
    order: 6;
    min-height: 50px;
    font-weight: 500;
  }
  .toolbar #btnPrint{ 
    font-size: 15px; 
    padding: 14px 8px; 
    flex: 1 1 calc(25% - 8px);
    min-width: 0;
    white-space: nowrap;
    order: 7;
    min-height: 50px;
    font-weight: 500;
  }
  .toolbar .help-btn{ 
    font-size: 20px; 
    padding: 14px 8px;
    flex: 1 1 calc(25% - 8px);
    min-width: 0;
    min-height: 50px;
    order: 8;
  }
  
  /* Stats móvil */
  .stats-container{ padding: 10px 12px; }
  .stats-row{ flex-direction: column; gap: 8px; }
  .stat-item{ min-width: auto; }
  .stat-label{ font-size: 13px; }
  .stat-value{ font-size: 16px; }
  .filtros-aplicados{ font-size: 12px; }
  
  /* Tabla móvil - columnas delgadas con wrap */
  .card{ 
    padding: 4px; 
    overflow-x: auto; 
    -webkit-overflow-scrolling: touch;
  }
  table{ 
    font-size: 11px; 
    min-width: 100%;
    width: 100%;
    table-layout: fixed;
  }
  th, td{ 
    padding: 8px 4px; 
    font-size: 11px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  th.sortable{ 
    font-size: 11px;
    padding: 8px 4px;
  }
  /* Título - columna delgada con wrap */
  td:nth-child(1), th:nth-child(1){ 
    width: 32%;
    white-space: normal;
    word-wrap: break-word;
    line-height: 1.3;
  }
  /* Categoría - columna delgada con wrap */
  td:nth-child(2), th:nth-child(2){ 
    width: 27%;
    white-space: normal;
    word-wrap: break-word;
    line-height: 1.3;
  }
  /* Caja - columna muy delgada */
  td:nth-child(3), th:nth-child(3){ 
    width: 10%;
    text-align: center;
  }
  /* Estado - columna para badge */
  td:nth-child(4), th:nth-child(4){ 
    width: 19%;
    padding: 8px 2px;
  }
  /* Acción - columna para botón */
  td:nth-child(5), th:nth-child(5){ 
    width: 12%;
    padding: 8px 2px;
  }
  .estado-badge{ 
    font-size: 9px; 
    padding: 4px 6px;
    white-space: normal;
    word-wrap: break-word;
    display: inline-block;
    width: 100%;
    text-align: center;
    box-sizing: border-box;
    line-height: 1.2;
  }
  button{ 
    font-size: 10px; 
    padding: 6px 4px;
    white-space: nowrap;
    width: 100%;
    box-sizing: border-box;
  }
  
  /* Diálogo móvil - reorganizado en columna única */
  dialog{ max-width: 98vw; max-height: 95vh; margin: 1vh auto; }
  
  /* Estado en diálogo móvil - extra grande y visible */
  dialog .estado-badge{ 
    padding: 20px 24px; 
    font-size: 20px; 
    font-weight: 700; 
    border-radius: 20px;
    margin: 12px 0;
    border-width: 3px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  }
  .dialog-container{ flex-direction: column; gap: 16px; }
  .dialog-container > .grid{ order: 1; }
  .portada-column{ order: 2; width: 100%; max-width: 100%; }
  .resumen-column{ order: 3; width: 100%; max-width: 100%; }
  .grid{ gap: 10px; }
  .grid label{ font-size: 13px; }
  .grid input, .grid select, .grid textarea{ font-size: 14px; padding: 8px; }
  .portada-placeholder{ min-height: 200px; }
  .portada-column img{ max-height: 300px; object-fit: contain; }
  .resumen-texto{ min-height: 180px; max-height: 250px; }
  
  /* Botones de préstamo/devolución en móvil */
  .prestamo-row{ flex-direction: column; gap: 8px; align-items: stretch; }
  .prestamo-row label{ width: 100%; }
  .prestamo-row button{ width: 100%; margin-top: 4px; padding: 12px; font-size: 14px; }
  
  /* Help dialog móvil */
  .help-dialog{ max-width: 98vw; max-height: 90vh; }
  .help-header{ padding: 12px 16px; }
  .help-header h2{ font-size: 18px; }
  .help-close{ font-size: 24px; width: 28px; height: 28px; }
  .help-content{ padding: 16px; font-size: 14px; }
  .help-content h1{ font-size: 22px; }
  .help-content h2{ font-size: 18px; }
  .help-content h3{ font-size: 16px; }
  
  /* Footer móvil */
  .footer{ margin-top: 32px; padding: 16px 0; }
  .footer-content p{ font-size: 12px; }
  .footer-links{ font-size: 12px; flex-direction: column; gap: 8px; }
  .footer-links .separator{ display: none; }
}

/* Landscape móvil */
@media (max-width: 768px) and (orientation: landscape) {
  dialog{ max-height: 90vh; }
  .help-dialog{ max-height: 85vh; }
  .help-content{ max-height: calc(85vh - 60px); }
}

/* Touch devices - áreas táctiles más grandes */
@media (hover: none) and (pointer: coarse) {
  .toolbar button{ min-height: 44px; }
  .toolbar select{ min-height: 44px; }
  .toolbar input{ min-height: 44px; }
  th.sortable{ padding: 12px 8px; }
  button{ min-height: 44px; }
}

@media print{
  @page{ size: A4 portrait; margin: 8mm 10mm; }
  body{ background: #fff; color:#000; font-size: 9px; line-height: 1.2; }
  .toolbar, dialog, button, .footer, .no-print{ display: none !important; }
  .container{ max-width: none; margin: 0; padding: 0; }
  .card{ border: none; padding: 0; }
  h1{ font-size: 16px; margin-bottom: 6px; }
  .stats-container{ font-size: 9px; padding: 6px 10px; margin-bottom: 6px; }
  .stat-value{ font-size: 11px; }
  .filtros-aplicados{ font-size: 8px; }
  table{ width:100%; border-collapse: collapse; font-size: 8px; }
  thead{ display: table-header-group; }
  thead th{ background:#fff !important; color:#000 !important; font-size: 9px; font-weight: 600; padding: 3px 4px !important; }
  th, td{ border:1px solid #999; padding: 2px 4px; }
  td{ line-height: 1.3; }
  tr{ break-inside: avoid; page-break-inside: avoid; }
  tbody{ display: table-row-group; }
  /* Ajustar anchos de columnas para optimizar espacio */
  th:nth-child(1), td:nth-child(1){ width: 45%; }
  th:nth-child(2), td:nth-child(2){ width: 25%; }
  th:nth-child(3), td:nth-child(3){ width: 10%; text-align: center; }
  th:nth-child(4), td:nth-child(4){ width: 20%; }
  /* Reducir espacio en badges de estado */
  .estado-badge{ padding: 2px 6px !important; font-size: 7px !important; border-radius: 8px !important; }
}
